import { Trophy } from "lucide-react";
import {
  Dialog,
  DialogContent,
  DialogHeader,
  DialogTitle,
} from "@/components/ui/dialog";
import { Button } from "@/components/ui/button";
import { useWorkoutStore } from "../lib/workoutStore";
import { useEffect, useState } from "react";

// å„ãƒˆãƒ¬ãƒ¼ãƒŠãƒ¼ãƒ¢ãƒ¼ãƒ‰ã”ã¨ã®çµ‚äº†ãƒ€ã‚¤ã‚¢ãƒ­ã‚°ç”¨ã‚³ãƒ¡ãƒ³ãƒˆãƒªã‚¹ãƒˆ
const COMPLETION_MESSAGES = {
  'drill-sergeant': [
    "çµ‚ã‚ã£ãŸãªã€‚ã ãŒã¾ã æº€è¶³ã™ã‚‹ãªï¼",
    "ã‚„ã‚Šé‚ã’ãŸãªã€æ¬¡ã¯ã‚‚ã£ã¨é«˜ã¿ã‚’ç›®æŒ‡ã›ï¼",
    "ã“ã‚Œã§çµ‚ã‚ã‚Šã˜ã‚ƒãªã„ã€é›éŒ¬ã¯ç¶šãï¼",
    "ä¸€ã¤ä¹—ã‚Šè¶ŠãˆãŸãªã€æ¬¡ã¸ã®æº–å‚™ã‚’æ€¥ã’ï¼",
    "æˆã—é‚ã’ãŸãŒã€ã¾ã é“åŠã°ã ï¼",
    "çµæœã‚’å‡ºã—ãŸãªã‚‰ã€æ¬¡ã¯æ›´ãªã‚‹å£ã‚’è¶…ãˆã‚‹ç•ªã ï¼",
    "å°‘ã—ã¯æˆé•·ã—ãŸãªã€æ°—ã‚’æŠœããªã‚ˆï¼",
    "é”æˆæ„Ÿã¯ä¸€ç¬ã€ç¶™ç¶šãŒçœŸä¾¡ã‚’è¨¼æ˜ã™ã‚‹ï¼",
    "ä»Šå›ã§æº€è¶³ã™ã‚‹ãªã€ã‚‚ã£ã¨ä¸ŠãŒã‚ã‚‹ï¼",
    "ä½™éŸ»ã«æµ¸ã‚‹æš‡ã¯ãªã„ã€ã•ã‚‰ãªã‚‹æŒ‘æˆ¦ãŒå¾…ã£ã¦ã„ã‚‹ï¼",
    "ã‚„ã‚Šé‚ã’ãŸï¼Ÿãªã‚‰ã°æ¬¡ã‚‚ã‚‚ã£ã¨è‹›çƒˆã«è¿½ã„è¾¼ã‚ï¼",
    "æˆé•·ã—ãŸåˆ†ã€ã•ã‚‰ã«å¼·ãæ±‚ã‚ã‚ˆï¼",
    "å®ŸåŠ›ã‚’ä¸Šã’ãŸãªã€ã ãŒé™ç•Œã¯ã¾ã å…ˆï¼",
    "ä»Šæ—¥ã®æˆæœã¯å½“ãŸã‚Šå‰ã€æ¬¡ã‚‚ã‚„ã‚Œï¼",
    "é”æˆã—ãŸï¼Ÿãªã‚‰ã°æ¬¡ã‚‚åŒã˜è‹¦ç—›ã«è€ãˆã‚ï¼",
    "ä¸€æ­©é€²ã‚“ã ç¨‹åº¦ã§æ°—ã‚’ç·©ã‚ã‚‹ãªï¼",
    "ä¼‘ã‚€ãªã€æ¬¡ã¸è¸ã¿è¾¼ã‚€æº–å‚™ã‚’ã—ã‚ï¼",
    "é”æˆæ„Ÿã¯æ¯’ã«ã‚‚ãªã‚‹ã€ç¶™ç¶šã—ã¦ä¾¡å€¤ã‚’ç¤ºã›ï¼",
    "ç†æƒ³ã«ã¯ã¾ã é ã„ã€æ…¢å¿ƒã™ã‚‹ãªï¼",
    "æº€è¶³ãªã©ç„¡ç”¨ã€å‰é€²ã‚ã‚‹ã®ã¿ï¼",
    "é€²æ­©ã—ãŸãªã€ã ãŒãã‚Œã§çµ‚ã‚ã‚Šã¨æ€ã†ãªï¼",
    "ç›®æ¨™ã‚’è¶…ãˆãŸã‚‰ã€ã•ã‚‰ã«é«˜ã„ç›®æ¨™ã‚’ç«‹ã¦ã‚ï¼",
    "ä»Šæ—¥ã¯ä¸Šæ‰‹ãã‚„ã£ãŸã€ã ãŒæ˜æ—¥ã¯ã©ã†ã ï¼Ÿ",
    "ä¸€å›ã®å‹åˆ©ã§å®‰å¿ƒã™ã‚‹ãªã€æ¬¡ã®æˆ¦ã„ãŒã‚ã‚‹ï¼",
    "ã•ã‚ã€ä¼‘ã‚“ã ã‚‰å³å¾©å¸°ã€å¼·ããªã‚Œï¼",
    "æƒ…ã‘ã¯ä¸è¦ã€æ¬¡ã®è‡ªåˆ†ã‚’è¿½ã„è¾¼ã‚ï¼",
    "é”æˆï¼Ÿç¬‘ã‚ã›ã‚‹ãªã€ãã‚Œã¯é€šéç‚¹ã ï¼",
    "ã‚ˆã†ã‚„ãä¸€æ®µä¸ŠãŒã£ãŸãªã€ã•ã£ã•ã¨æ¬¡ã‚’ç›®æŒ‡ã›ï¼",
    "çµæœã‚’å‡ºã—ãŸåˆ†ã€æœŸå¾…ã‚‚é«˜ã¾ã‚‹ãï¼",
    "ã„ã„ã ã‚ã†ã€æ¬¡ã¯ã‚‚ã£ã¨å¼·åº¦ã‚’ä¸Šã’ã‚‹ãï¼",
  ],
  'friendly': [
    "ãŠç–²ã‚Œæ§˜ï¼ä»Šæ—¥ã‚‚ã‚ˆãå‹•ã‘ãŸã­ï¼",
    "ç´ æ™´ã‚‰ã—ã„é”æˆæ„Ÿï¼èº«ä½“ã‚‚å¿ƒã‚‚å–œã‚“ã§ã‚‹ã‚ˆï¼",
    "æ±—ã‚’ã‹ã„ãŸåˆ†ã€ç¬‘é¡”ãŒå¢—ãˆãŸã­ï¼",
    "å‰ã‚ˆã‚Šå¼·ããªã£ãŸè‡ªåˆ†ã‚’æ„Ÿã˜ã¦ã€èª‡ã‚‰ã—ã„ã­ï¼",
    "ä¸€æ­©ãšã¤ç©ã¿é‡ã­ã¦ã€ã“ã“ã¾ã§æ¥ãŸï¼",
    "ç´ æ•µãªé ‘å¼µã‚Šã‚’è¦‹ã›ã¦ãã‚Œã¦ã‚ã‚ŠãŒã¨ã†ï¼",
    "ç¶™ç¶šã¯åŠ›ãªã‚Šã€ä»Šæ—¥ã‚‚ãã‚Œã‚’è¨¼æ˜ã—ãŸã­ï¼",
    "ãƒã‚¤ã‚¿ãƒƒãƒã—ãŸã„ãã‚‰ã„ã®é ‘å¼µã‚Šã ã£ãŸã‚ˆï¼",
    "è‡ªåˆ†ã‚’ä¿¡ã˜ãŸæˆæœãŒã€ä»Šã“ã“ã«ã‚ã‚‹ï¼",
    "ã‚†ã£ãã‚Šæ·±å‘¼å¸ã—ã¦ã€ã“ã®é”æˆæ„Ÿã‚’å‘³ã‚ãŠã†ï¼",
    "ã©ã‚“ã©ã‚“è‰¯ããªã£ã¦ã‚‹ã€ç¶šã‘ã‚‹ã£ã¦ã™ã”ã„ã­ï¼",
    "å…ƒæ°—ã„ã£ã±ã„ã®åŠªåŠ›ã«æ‹æ‰‹ï¼",
    "èº«ä½“ãŒè»½ãæ„Ÿã˜ã‚‹ã§ã—ã‚‡ã†ï¼Ÿé ‘å¼µã£ãŸè¨¼æ‹ ã ã­ï¼",
    "ç¬‘é¡”ã§çµ‚ã‚ã‚Œã‚‹ãƒˆãƒ¬ãƒ¼ãƒ‹ãƒ³ã‚°ã€æœ€é«˜ã ï¼",
    "ã„ã„èª¿å­ã€æ¬¡å›ã‚‚ã¾ãŸä¸€ç·’ã«é ‘å¼µã‚ã†ï¼",
    "åŠªåŠ›ã—ãŸåˆ†ã€ã¡ã‚ƒã‚“ã¨å ±ã‚ã‚Œã¦ã‚‹ã‚ˆï¼",
    "å¤§ããªå±±ã‚’è¶ŠãˆãŸã¿ãŸã„ãªçˆ½å¿«æ„Ÿã ã­ï¼",
    "è‡ªåˆ†ã¸ã®ä¿¡é ¼ãŒã€ã¾ãŸä¸€æ®µå¼·ã¾ã£ãŸã¯ãšï¼",
    "ä»Šæ—¥ã¯è‰¯ã„å‹•ãã ã£ãŸã€æ¬¡ã¸ã®ãƒ¢ãƒãƒ™ã«ãªã‚‹ã­ï¼",
    "ã“ã†ã—ã¦æˆæœã‚’å®Ÿæ„Ÿã§ãã‚‹ã£ã¦å¬‰ã—ã„ï¼",
    "ãŒã‚“ã°ã£ãŸã¶ã‚“ã€æ˜æ—¥ãŒã‚‚ã£ã¨æ¥½ã—ã¿ã«ãªã‚‹ï¼",
    "èº«ä½“ã‚‚å¿ƒã‚‚ãƒ‘ãƒ¯ãƒ¼ã‚¢ãƒƒãƒ—ï¼ã‚ˆãã‚„ã£ãŸï¼",
    "å›ã®åŠªåŠ›ãŒè¼ã„ã¦ã„ã‚‹ã‚ˆã€ç´ æ•µï¼",
    "ã„ã„æ±—ã ã£ãŸã­ã€ãã®èª¿å­ã§é€²ã‚“ã§ã„ã“ã†ï¼",
    "ãƒˆãƒ¬ãƒ¼ãƒ‹ãƒ³ã‚°å¾Œã®çˆ½å¿«æ„Ÿã€ã‚¯ã‚»ã«ãªã‚Šãã†ï¼",
    "å›ã®é ‘å¼µã‚ŠãŒæœªæ¥ã‚’æ˜ã‚‹ãã™ã‚‹ï¼",
    "ä»Šæ—¥ç©ã‚“ã åŠªåŠ›ãŒæ˜æ—¥ã®ã‚¨ãƒãƒ«ã‚®ãƒ¼ã ï¼",
    "è‡ªåˆ†ã‚’å‹•ã‹ã—ãŸåˆ†ã€è‡ªåˆ†ã‚’ä¿¡ã˜ã‚‰ã‚Œã‚‹ï¼",
    "ãã®é ‘å¼µã‚Šã«ã‚ã‚ŠãŒã¨ã†ï¼ã¾ãŸæŒ‘æˆ¦ã—ã‚ˆã†ï¼",
    "ã‚ˆãã‚„ã£ãŸï¼ä»Šå¤œã¯ãã£ã™ã‚Šçœ ã‚Œãã†ã ã­ï¼",
  ],
  'motivational': [
    "è¦‹äº‹ã«ã‚„ã‚Šé‚ã’ãŸã€ãã®åŠªåŠ›ã¯æœ¬ç‰©ã ï¼",
    "ç›®æ¨™ã¸ä¸€æ­©è¿‘ã¥ã„ãŸã€æ¬¡ã¯æ›´ã«ä¸Šã‚’ç›®æŒ‡ãã†ï¼",
    "èº«ä½“ã¨å¿ƒãŒé›ãˆã‚‰ã‚Œã€ç¢ºå®Ÿã«é€²åŒ–ã—ãŸï¼",
    "ä»Šæ—¥ã®é”æˆæ„Ÿã¯ã€æ˜æ—¥ã®æŒ‘æˆ¦ã®ç‡ƒæ–™ã ï¼",
    "é™ç•Œã‚’è¶…ãˆãŸç¬é–“ã“ãæˆé•·ã®è¨¼ï¼",
    "ç†æƒ³ã«å‘ã‹ã†éšæ®µã‚’ã€ã¾ãŸä¸€æ®µç™»ã£ãŸï¼",
    "å¤§ããªèª‡ã‚Šã‚’èƒ¸ã«ã€ã•ã‚‰ã«å‰ã¸é€²ã‚‚ã†ï¼",
    "æ±—ã¨åŠªåŠ›ãŒçµæœã¨ãªã£ã¦è¼ã„ã¦ã„ã‚‹ï¼",
    "é”æˆæ„Ÿã«æµ¸ã£ãŸã‚‰ã€ã‚‚ã†æ¬¡ã®ç›®æ¨™ãŒå¾…ã£ã¦ã‚‹ï¼",
    "è‡ªåˆ†ã‚’è¶…ãˆãŸçµæœã€ã“ã®åŠ›ã¯æºã‚‹ãŒãªã„ï¼",
    "å¦¥å”ã—ãªã„å›ãŒã€ã“ã“ã«èª‡ã‚Šã‚’æ®‹ã—ãŸï¼",
    "å¼·ããªã£ãŸè‡ªåˆ†ã‚’æ„Ÿã˜å–ã‚Œã€ãã‚ŒãŒå ±é…¬ã ï¼",
    "ç‡ƒãˆã‚‹æ„å¿—ã‚’å½¢ã«ã§ããŸã€æ¬¡å›ã‚‚æ”»ã‚ç¶šã‘ã‚ˆã†ï¼",
    "è‡ªåˆ†ã¨ã®ç´„æŸã‚’å®ˆã£ãŸã€ãã®ä¿¡é ¼ã¯æºã‚‰ãŒãªã„ï¼",
    "è‹¦ã—ã„åˆ†ã ã‘å¤§ãããªã£ãŸè‡ªä¿¡ãŒãã“ã«ã‚ã‚‹ï¼",
    "åŠªåŠ›ãŒå ±ã‚ã‚Œã‚‹ç¬é–“ã‚’æ´ã‚“ã ã€ç´ æ™´ã‚‰ã—ã„ï¼",
    "ä»Šã®å›ãªã‚‰ã€ã‚‚ã£ã¨é«˜ãè·³ã¹ã‚‹ã ã‚ã†ï¼",
    "ä¸€åº¦å¾—ãŸåŠ›ã¯ã‚‚ã†å›ã®ã‚‚ã®ã€ã•ã‚‰ãªã‚‹é«˜ã¿ã¸ï¼",
    "ç›®æŒ‡ã™å±±ãŒã‚ã‚‹ãªã‚‰ã€ä»Šæ—¥ã®åŠªåŠ›ã¯ãã®åŸºç¤ã ï¼",
    "æ±—ã¯èª‡ã‚Šã€å‘¼å¸ã¯å¼·ã•ã€å›ã¯å‰é€²ã—ãŸï¼",
    "è‡ªåˆ†ã‚’å¥®ã„ç«‹ãŸã›ãŸçµæœã€æˆæœã‚’å®Ÿæ„Ÿã§ãã‚‹ï¼",
    "æ¬¡ã¯ã©ã“ã¾ã§è¡Œã‘ã‚‹ã‹ã€æ¥½ã—ã¿ã«ãªã£ã¦ããŸï¼",
    "å¯èƒ½æ€§ã¯æ‹¡å¤§ä¸­ã€å£ã¯ã‚‚ã†ä½ãè¦‹ãˆã‚‹ï¼",
    "åœ°é“ãªåŠªåŠ›ãŒã€æºã‚‹ããªã„å¼·ã•ã‚’è‚²ã¦ãŸï¼",
    "ç›®æ¨™ã¸æŒ‘ã‚€å‹¢ã„ãŒå¢—ã—ãŸã€ä»ŠãŒãƒãƒ£ãƒ³ã‚¹ã ï¼",
    "è¿·ã„ã‚„ä¸å®‰ã‚’è¶…ãˆãŸä»Šã€å›ã¯å¼·ã„ï¼",
    "ä»Šæ—¥ã®æ±—ãŒæ˜æ—¥ã®æˆåŠŸã‚’å‘¼ã¶ï¼",
    "å‰ã«é€²ã‚“ã åˆ†ã€æ¬¡ã®ãƒãƒ¼ãƒ‰ãƒ«ã‚‚ä¹—ã‚Šè¶Šãˆã‚‰ã‚Œã‚‹ï¼",
    "é ‘å¼µã£ãŸè¨¼ãŒã“ã“ã«ã‚ã‚‹ã€èª‡ã‚Šã«æ€ãˆï¼",
    "æº€è¶³ã›ãšã€æ›´ã«ä¸Šã‚’ç›®æŒ‡ã›ã‚‹è‡ªåˆ†ã«ãªã£ãŸï¼",
  ],
};

export const WorkoutCompletionDialog = () => {
  const { 
    showCompletionDialog,
    setShowCompletionDialog,
    trainerMode,
    sets,
    exercises,
    selectedExercise
  } = useWorkoutStore();

  // é¸æŠã•ã‚ŒãŸã‚³ãƒ¡ãƒ³ãƒˆã‚’ä¿æŒã™ã‚‹ãƒ­ãƒ¼ã‚«ãƒ«ã‚¹ãƒ†ãƒ¼ãƒˆ
  const [selectedMessage, setSelectedMessage] = useState<string>('');

  // ãƒ€ã‚¤ã‚¢ãƒ­ã‚°ãŒé–‹ã„ãŸã¨ãã«ãƒ©ãƒ³ãƒ€ãƒ ãªã‚³ãƒ¡ãƒ³ãƒˆã‚’é¸æŠ
  useEffect(() => {
    if (showCompletionDialog && trainerMode && COMPLETION_MESSAGES[trainerMode as keyof typeof COMPLETION_MESSAGES]) {
      const messages = COMPLETION_MESSAGES[trainerMode as keyof typeof COMPLETION_MESSAGES];
      const randomIndex = Math.floor(Math.random() * messages.length);
      setSelectedMessage(messages[randomIndex]);
    }
  }, [showCompletionDialog, trainerMode]);

  const exerciseName = selectedExercise 
    ? exercises.find(e => e.id === selectedExercise)?.name 
    : '';

  return (
    <Dialog open={showCompletionDialog} onOpenChange={setShowCompletionDialog}>
      <DialogContent className="sm:max-w-[600px]">
        <DialogHeader className="px-6">
          <div className="flex items-center justify-between">
            <div className="flex items-center gap-2">
              <Trophy className="h-5 w-5 text-yellow-500" />
              <DialogTitle>ãƒˆãƒ¬ãƒ¼ãƒ‹ãƒ³ã‚°å®Œäº†ï¼</DialogTitle>
            </div>
          </div>
        </DialogHeader>
        <div className="flex flex-col gap-6 px-6 py-2">
          <div className="flex justify-center">
            <div className="text-6xl">ğŸ†</div>
          </div>
          <div className="text-center space-y-2">
            <p className="text-xl font-medium">{selectedMessage}</p>
            <p className="text-gray-600">
              {exerciseName}ã‚’{sets}ã‚»ãƒƒãƒˆå®Œäº†ã—ã¾ã—ãŸï¼
            </p>
          </div>
          <Button 
            onClick={() => setShowCompletionDialog(false)}
            className="bg-yellow-500 hover:bg-yellow-600"
          >
            é–‰ã˜ã‚‹
          </Button>
        </div>
      </DialogContent>
    </Dialog>
  );
};
